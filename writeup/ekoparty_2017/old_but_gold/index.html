<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>Old_but_gold</title>
  <meta property="og:title" content="Old_but_gold" />
  <meta name="twitter:title" content="Old_but_gold" />
  <meta name="description" content="EKOParty 2016 CTF - 250 points - Misc">
  <meta property="og:description" content="EKOParty 2016 CTF - 250 points - Misc">
  <meta name="twitter:description" content="EKOParty 2016 CTF - 250 points - Misc">
  <meta name="author" content="bfe"/>
  <link href='https://www.bitsforeveryone.com/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://www.bitsforeveryone.com/img/bfe.png" />
  <meta name="twitter:image" content="https://www.bitsforeveryone.com/img/bfe.png" />
  <meta name="twitter:card" content="summary" />
  <meta property="og:url" content="https://www.bitsforeveryone.com/writeup/ekoparty_2017/old_but_gold/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="BitsForEveryone" />

  <meta name="generator" content="Hugo 0.30.2" />
  <link rel="canonical" href="https://www.bitsforeveryone.com/writeup/ekoparty_2017/old_but_gold/" />
  <link rel="alternate" href="https://www.bitsforeveryone.com/index.xml" type="application/rss+xml" title="BitsForEveryone">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" integrity="sha384-wITovz90syo1dJWVh32uuETPVEtGigN07tkttEqPv+uR2SE/mbQcG7ATL28aI9H0" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://www.bitsforeveryone.com/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://www.bitsforeveryone.com/css/pygment_highlights.css" />
  <link rel="stylesheet" href="https://www.bitsforeveryone.com/css/highlight.min.css" />


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.css" integrity="sha256-sCl5PUOGMLfFYctzDW3MtRib0ctyUvI9Qsmq2wXOeBY=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/default-skin/default-skin.min.css" integrity="sha256-BFeI1V+Vh1Rk37wswuOYn5lsTcaU96hGaI7OUVCLjPc=" crossorigin="anonymous" />



<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://www.bitsforeveryone.com/">BitsForEveryone</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Writeups</a>
              <div class="navlinks-children">
                
                  <a href="/page/all">all</a>
                
                  <a href="/writeup/csaw_2017/">CSAW 2017</a>
                
                  <a href="/writeup/ekoparty_2017/">EKO Party CTF 2016</a>
                
                  <a href="/writeup/plaid_2017/">Plaid 2017</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="Projects" href="/project/">Projects</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        
          
            <li>
              <a title="About" href="/page/about/">About</a>
            </li>
          
        

        

        
      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="BitsForEveryone" href="https://www.bitsforeveryone.com/">
            <img class="avatar-img" src="https://www.bitsforeveryone.com/img/bfe.png" alt="BitsForEveryone" />
          </a>
        
      </div>
    </div>

  </div>
</nav>




    
  
  
  




  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="writeup-heading">
              <h1>Old_but_gold</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <h4 id="ekoparty-2016-ctf-250-points-misc">EKOParty 2016 CTF - 250 points - Misc</h4>

<p>
<strong>Description - These QR codes look weird</strong><br />
<strong>Files: <a href="https://github.com/bitsforeveryone/write-ups/raw/master/EKOPartyCTF_2016/misc250/misc250_100ff979353dd452.zip">Zip Files</a></strong></p>

<p><em>Solved by madeye</em></p>

<p>My teammates immediately pointed this challenge out to me since they knew I loved punch cards. A few months prior, I had written a challenge for our internal try-out CTF in which they were given a base64 encoced ascii art image of an IBM-29 punch card with a message encoded for them. It was a favorite for the students. It took me about 20 minutes to repurpose my code to solve this challenge.</p>

<p>When extracted, the zip file contains 14 PNG files that are images of IBM-29 punch cards. The images are consistently the same size and with equally spaced punches. Iterating over each column then each row, you can read the punch if the pixel in the top left corner is white. The top row, left most column starts at pixel column 15 and pixel row 20. Each punch location is then spaced 20 pixel vertically and 7 pixels horizontally.</p>

<p>Using PIL, I was able to read each image to find the punches on each row. The following code returns a list of columns of punches, where each column is a list of the rows that are punched.</p>

<pre><code class="language-python">def convert(imgfile):
    image = Image.open(imgfile)
    im = image.load()
    xstart = 15
    ystart = 20
    xoff = 7
    yoff = 20
    allpunches = []
    for x in range(xstart,image.size[0],xoff):
        punches = []
        for y in range(ystart,image.size[1],yoff):
            if im[x,y] == (255,255,255,255):
                punches.append((y-ystart)/yoff)
        allpunches.append(holes(punches))
    return allpunches

</code></pre>

<p>The list of punches now needs to be converted to a string of characters. Understanding the layout of the punches as shown <a href="http://www.columbia.edu/cu/computinghistory/029-card.jpg">here</a>, we can script this up as follows. <em>note: not all puncutations are converted, just the ones observed on this set of cards</em>.</p>

<pre><code class="language-python">def readpunch(p):
    if len(p) &gt; 2:
        if p == [2,5,10]: return ','
        if p == [0,5,10]: return '.'
        if p == [2,9,10]: return '?'
        if p == [0,7,10]: return '('
        if p == [1,7,10]: return ')'
    if len(p) == 0:
        return ' '
    if len(p) == 1:
        return alphabet[p[0]-2]
    elif p[0] == 0:
        return alphabet[7+p[1]]
    elif p[0] == 1:
        return alphabet[16+p[1]]
    elif p[0] == 2:
        return alphabet[24+p[1]]
</code></pre>

<p>Now we just need to iterate over all 14 cards provided in the zip file to get the text for each card.</p>

<pre><code class="language-python">for f in files:
    print ''.join([readpunch(p) for p in convert(f)])
</code></pre>

<p>The cards in alphabetical order by file name produces the following text. Reading through each line to determine the follow of the story is needed. I did not see any logical way to automate this. I have indicated the final line number after each row of text</p>

<pre><code>OF TIME PUNCHING THOSE NARDS, CAN YOU IMAGINE WHAT COULD      [8]
THE BUG, BUT THOSE WER3 THE OLD DAYS. CAN YOU FIND THE FLAG   [13]
USING THIS OLD TECHNOLOGY? GOOD LUCK, YOU WILL NEED IT)       [14]
IT WAS THE SIXTIES, HE WAS TRYKNG TO FIGURE OUT HOW TO        [2]
MANUALS TRY1NG TO LEARN HOW TO PROGRAM AND SPEND A LOT        [7]
HAPPEN IF YOU FAKE A SMALL MISTAKE IN ON OF THOSE PUNCHED     [9]
USE THOSE PONCHED CARDS, HE LIKES TO PROGRAM IN FORTRAN       [3]
ERROR DUE TO A SMALL AND ALMOST INSIGNIFICANT MIST4KE BUT     [11]
AND COBOL, B(T EVEN AFTER ALL THOSE YEARS HE DOESNT KNOW      [4]
CARDS? AFTER THOSE HOURS WAITING ROR A RESULT, THEN IT SAYS   [10]
IN THOSE DAYS YOUR ONLY OPTION W4S READ LARGE BOOKS AND       [6]
HOW TO PROPERLY MRITE SECURE CODE IN THOSE LANGUAGES          [5]
THAT WILL TAKE MORE TIME TO MEBUG AND FIGURE OUT WHERE WAS    [12]
ONCE UPON A TEME, THERE WAS A YOUNG HACKER CALLED MJ          [1]
</code></pre>

<p>Following along with the story, it talks about mistakes. There are also some mistakes in the story. After double checking that the solver was correct, I noticed the first three typos were E, K, O which matches the flag pattern. In order, the flag properly describes the system that used the punchcards. <em>note: some writeups show the flag using the parenthesis, but since there was no symbol for curly braces I submited the flag with the curlies and got the points</em></p>

<pre><code>EKO{M41NFR4M3}
</code></pre>

<p>Entire solve script can be found <a href="https://raw.githubusercontent.com/bitsforeveryone/write-ups/master/EKOPartyCTF_2016/misc250/solver.py">here</a></p>

<p><strong>Constant Vigilance!!</strong></p>
      </article>

      <ul class="pager blog-pager">
        
        
      </ul>

      
        
      

    </div>
  </div>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="https://github.com/bitsforeveryone" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="https://www.bitsforeveryone.com/index.xml" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://www.bitsforeveryone.com">bfe</a>
                      
          
          
          &nbsp;&bull;&nbsp;
          2017

          
            &nbsp;&bull;&nbsp;
            <a href="https://www.bitsforeveryone.com/">BitsForEveryone</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          Built with <a href="http://gohugo.io">Hugo</a>&nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>&nbsp;&bull;&nbsp; Adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js" integrity="sha384-/y1Nn9+QQAipbNQWU65krzJralCnuOasHncUFXGkdwntGeSvQicrYkiUBwsgUqc1" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/contrib/auto-render.min.js" integrity="sha384-dq1/gEHSxPZQ7DdrM82ID4YVol9BYyU7GbWlIwnwyPzotpoc57wDw/guX8EaYGPx" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://www.bitsforeveryone.com/js/main.js"></script>
<script src="https://www.bitsforeveryone.com/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk=" crossorigin="anonymous"></script>
<script src="https://www.bitsforeveryone.com/js/load-photoswipe.js"></script>



  </body>
</html>

